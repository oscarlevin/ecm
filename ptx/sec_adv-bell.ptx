<?xml version="1.0" encoding="UTF-8"?>
<section xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="sec_adv-bell">

  <title>Bell Numbers</title>

    <p>
      The Bell number, <m>B_{k}</m>, denotes the number of ways that a set of <m>k</m> objects can be partitioned into nonempty subsets.
      We have already seen how to partition a set of <m>k</m> objects into exactly <m>n</m> subsets: <m>S(k,n)</m>.  So on its face, <m>B_k = \sum_{n=1}^kS(k,n)</m>.
    </p>

    <p>
      The sequence of Bell numbers starts
      <me>
        1, 1, 2, 5, 15, 52, 203, 877, 4140, 21147, 115975, \ldots
      </me>
      Notice that the first four numbers look like Catalan numbers.  In fact, one of the many things the Catalan numbers count are <em>non-intersecting</em> set partitions.  Once you believe this, you see that <m>C_n \le B_n</m> for all <m>n</m>.
    </p>


    <p>
      The Bell numbers can be generated by constructing what is called the Bell Triangle. To construct this triangle, begin with a 1 at the top and a 1 below it. Add these two numbers together and put the sum 2, to the right of the 1 in the second column. This 2 is also the first entry of the third row. The second entry in the third row is found by adding the 2 to the number 1 above it. This sum is 3 and goes to the right of the 2. The 3 is now below a 2. Adding these two numbers produces the last number, 5, in the third row. Since 5 has no number above it, the third row is complete. 5 now becomes the first number in the fourth row and the process continues.
    </p>

    <sidebyside width="70%">
      <tabular>
      <row><cell>1</cell> <cell> </cell> <cell> </cell> <cell> </cell> <cell></cell><cell/><cell/> </row>
      <row><cell>1 </cell><cell> 2 </cell><cell> </cell><cell> </cell><cell> </cell><cell/><cell/> </row>
      <row><cell>2 </cell><cell> 3 </cell><cell> 5 </cell><cell> </cell><cell> </cell><cell/><cell/> </row>
      <row><cell>5 </cell><cell> 7 </cell><cell> 10 </cell><cell> 15 </cell><cell> </cell><cell/><cell/> </row>
      <row><cell>15 </cell><cell> 20 </cell><cell> 27 </cell><cell> 37 </cell><cell> 52</cell><cell/><cell/> </row>
      <row> <cell>52 </cell><cell>67</cell><cell> 87</cell><cell> 114</cell><cell> 151</cell><cell> 203</cell><cell/></row>

      <row><cell> 203 </cell><cell>255</cell><cell> 322</cell><cell> 409</cell><cell> 523</cell><cell> 674</cell><cell> 877</cell></row>
    </tabular>
    </sidebyside>


    <p>
      To summarize, construction of the triangle follows two basic rules:
      <ol>
        <li>
          <p>
            The last number of each row is the first number of the next row.
          </p>
        </li>
        <li>
          <p>
            All other numbers are found by adding the number to the left of the
            missing number to the number directly above this same number.
          </p>
        </li>
      </ol>

      When the triangle is extended, as above, the Bell Numbers are found down
      the first column as well as along the outside diagonal.
    </p>

    <activity>
      <statement>
        <p>
          Why does this triangle construction give you the Bell numbers?  Explain in terms of set partitions.
        </p>
      </statement>
    </activity>


    <p>
      As with Pascal's Triangle, the Bell triangle has several interesting
      properties.
    </p>

    <activity>
      <statement>
        <p>
          If the sum of a row is added to the Bell number at the end of that row, the next Bell number is obtained. For example, the sum of the fourth row plus the Bell number at the end of the row: <m>15 + 20 + 27 + 37 + 52 + 52</m> is 203, the next Bell number.  Why does this happen?
        </p>
      </statement>
    </activity>

    <activity>
      <statement>
        <p>
          Another pattern you might notice: the numbers of the second diagonal <m>1, 3, 10, 37, 151, 674, \ldots</m> are the sums of the horizontal rows.  Prove this!
        </p>
      </statement>
    </activity>

    <p>
      Rotating the triangle slightly creates a <em>difference</em> triangle analogous to Pascal's Triangle. The entries that are formed recursively by adding in Pascal's Triangle are now differences of the two numbers above them in the Bell triangle.
    </p>

    <sidebyside width="100%">
      <tabular>
        <row>
          <cell>1</cell><cell/><cell>2</cell><cell/><cell>5</cell><cell/><cell>15</cell><cell/><cell>52</cell><cell/><cell>203</cell><cell/><cell>877</cell><cell><m>\ldots</m></cell>
        </row>
        <row>
          <cell/><cell>1</cell><cell/><cell>3</cell><cell/><cell>10</cell><cell/><cell>37</cell><cell/><cell>151</cell><cell/><cell>674</cell><cell><m>\ldots</m></cell><cell/>
        </row>
        <row>
          <cell/><cell/>
          <cell>2</cell><cell/><cell>7</cell><cell/><cell>27</cell><cell/><cell>114</cell><cell/><cell>523</cell><cell><m>\ldots</m></cell><cell/><cell/>
        </row>
        <row>
          <cell/><cell/><cell/>
          <cell>5</cell>
          <cell/><cell>20</cell><cell/><cell>87</cell><cell/><cell>409</cell><cell><m>\ldots</m></cell><cell/><cell/><cell/>
        </row>
        <row>
          <cell/><cell/><cell/><cell/>
          <cell>15</cell>
          <cell/><cell>67</cell><cell/><cell>322</cell><cell><m>\ldots</m></cell><cell/><cell/><cell/><cell/>
        </row>
        <row>
          <cell/><cell/><cell/><cell/><cell/>
          <cell>52</cell>
          <cell/><cell>255</cell><cell><m>\ldots</m></cell><cell/><cell/><cell/><cell/><cell/>
        </row>
        <row>
          <cell/><cell/><cell/><cell/><cell/><cell/>
          <cell>203</cell>
          <cell><m>\ldots</m></cell><cell/><cell/><cell/><cell/><cell/><cell/>
        </row>
      </tabular>
    </sidebyside>

    <activity>
      <statement>
        <p>
          Explain why the differences work as they do in the rotated triangle.
        </p>
      </statement>
    </activity>

    <p>
      Finally, rewriting the Bell triangle recursively indicates a nice
      connection of the Bell Numbers to Pascal's triangle.
    </p>

    <sidebyside width="100%">
      <tabular>
        <row>
          <cell>
            <m>B_{0} = B_{1}</m>
          </cell>
          <cell/><cell/><cell/>
        </row>
        <row>
          <cell>
            <m>B_{1}</m>
          </cell>
          <cell>
            <m>B_{0} + B_{1} = B_{2}</m>
          </cell>
          <cell/><cell/>
        </row>
        <row>
          <cell>
            <m>B_{2}</m>
          </cell>
          <cell>
            <m>B_{1} + B_{2}</m>
          </cell>
          <cell>
            <m>B_{0} + 2B_{1} + B_{2} = B_{3}</m>
          </cell>
          <cell/>
        </row>
        <row>
          <cell>
            <m>B_{3}</m>
          </cell>
          <cell>
            <m>B_{2} + B_{3}</m>
          </cell>
          <cell>
            <m>B_{1} + B_{2} + B_{2} + B_{3}</m>
          </cell>
          <cell>
            <m>B_{0} + 3B_{1} + 3B_{2} + B_{3} = B_{4}</m>
          </cell>
        </row>
      </tabular>
    </sidebyside>

    <p>
      This pattern suggests the <m>{(n + 1)}^{\text{th}}</m> Bell Number can be represented recursively by <m>B_{n + 1} = \binom{n}{0} B_{0} + \binom{n}{1} B_{1} + \binom{n}{2}B_{2} + \ldots + \binom{n}{n} B_{n}</m>. The coefficients of this equation are the entries of the <m>n</m>th row of Pascal's triangle.
    </p>

    <activity xml:id="act_bellrecurrence">
      <statement>
        <p>
          Prove the recurrence <me>B_{k + 1} = \binom{k}{0} B_{0} + \binom{k}{1} B_{1} + \binom{k}{2}B_{2} + \ldots + \binom{k}{k} B_{k}</me>
        </p>
      </statement>
    </activity>


    <p>
      The Bell numbers are related to the Stirling numbers and can be defined
      as the sum of the Stirling numbers of the second kind.
      That is, <m>B_{k} = S(k,1) + S(k,2) + \cdots + S(k,k)</m>, where <m>S(k,n)</m> represents the number of ways of grouping <m>k</m> elements into <m>n</m> subsets.
      So <m>B_{3} = S(3,1) + S(3,2) + S(3,3) = 1 + 3 + 1 = 5</m>.
      Since the Bell numbers count the partitions of a set of elements, they are used in prime-number theory to enumerate the number of ways to factor a number with distinct prime factors.
      For example, 42 has three distinct prime factors: 2, 3, and 7.
      Since <m>B_{3} = 5</m> , we know there are five ways of factoring 42.
      These are <m>2 \times 3 \times 7</m>, <m>2 \times 21</m>, <m>3 \times 14</m>, <m>6 \times 7</m>, and <m>42</m>.
      So the number <m>210</m>, which has 4 distinct factors, 2, 3, 5, and 7, can be factored in <m>B_{4} = 15</m> ways.
    </p>



    <p>
      The Bell numbers can be used to model many real-life situations. For
      example, the number of different ways two people can sleep in unlabeled
      twin beds is <m>B_{2} = 2</m> ways: They can sleep in the same bed or in
      separate beds. The number of ways of serving a dinner consisting of
      three items, such as a salad, bread, and fish is <m>B_{3} = 5</m> ways:
      each could be served on a separate plate, salad and bread could be on
      one plate and fish on another, salad and fish on one plate and bread on
      another, or all three items could be on the same plate. This example
      serves as a model for the five ways three people can occupy three
      unlabeled beds, the five ways three prisoners can be handcuffed
      together, the five ways three nations can be form alliances, or any
      situation of partitioning three distinct elements into non-empty
      subsets.
    </p>

    <p>
      One interesting application of Bell numbers is in counting the number of
      rhyme schemes possible for a stanza in poetry. There are <m>B_{2} = 2</m> possibilities for a two-line stanza: the lines can either rhyme or not
      rhyme. The possible rhyme schemes of a three-line stanza can be
      described as aaa, aab, aba, abb, and abc: thus there are 5 or <m>B_{3}</m> possible rhyme schemes. The Japanese used diagrams depicting possible
      rhyme schemes of a five-line stanza <m>B_{5} = 52</m> as early as 1000
      A.D. in the <em>Tale of the Genji</em> by Lady Shikibu Murasaki.
    </p>

    <p>
      We conclude with an interesting activity.
    </p>
    <activity>
      <statement>
        <p>
          The set <m>\{u_{0}, u_{1}, u_{2}, \ldots \}</m> where <m>u_{0} = 1</m>, <m>u_{1} = x</m>, <m>u_{2} = x(x - 1)</m>, <m>u_{3} = x(x - 1)(x - 2)</m>, etc., is a basis for the vector space <m>V</m> of all polynomials with real coefficients.
          Let <m>P(x) = c_{0}u_{0} + c_{1}u_{1} + c_{2}u_{2} + \cdots</m> be any element of <m>V</m>, and define the functional <m>L</m> as follows: <m>L\lbrack P(x)\rbrack = c_{0} + c_{1} + \cdots</m>.
        </p>
        <p>
          <ol>
            <li>
              <p>
                Prove that <m>L\left\lbrack P\left( x \right) + Q\left( x \right) \right\rbrack = L\left\lbrack P\left( x \right) \right\rbrack + L\left\lbrack Q\left( x \right) \right\rbrack.</m>
              </p>
            </li>
            <li>
              <p>
                Prove that <m>L\left\lbrack rP \left( x \right) \right\rbrack = rL\lbrack P\left( x \right)\rbrack</m> for <m>r \in \R</m> (the Reals).
              </p>
            </li>
            <li>
              <p>
                Prove that <m>B_{n} = L\lbrack x^{n}\rbrack</m> .
              </p>
            </li>
            <li>
              <p>
                Prove that <m>L\left\lbrack x^{n + 1} \right\rbrack = L\lbrack\left( x + 1 \right)^{n}\rbrack</m> .
              </p>
            </li>
            <li>
              <p>
                Derive the recursion in <xref ref="act_bellrecurrence"/> using the previous part.
              </p>
            </li>
          </ol>
        </p>
      </statement>
    </activity>

</section>
